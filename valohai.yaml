---
- step:
    name: keras-dvc-cnn-pretrained
    image: tensorflow/tensorflow:1.5.0-devel-gpu
    command: python keras-dvc-cnn-pretrained.py
    inputs:
      - name: training-set-images
        default: swift://f8a5dbc8033343aea820c139245afe13/BDA/train/train-set-images.tar.gz
      - name: test-set-images
        default: swift://f8a5dbc8033343aea820c139245afe13/BDA/test/test-set-images.tar.gz
      - name: validation-set-images
        default: swift://f8a5dbc8033343aea820c139245afe13/BDA/validation/validation-set-images.tar.gz

- step:
    name: keras-dvc-cnn-simple
    image: tensorflow/tensorflow:1.5.0-devel-gpu
    command: python keras-dvc-cnn-simple.py 
    inputs:
      - name: training-set-images
        default: swift://f8a5dbc8033343aea820c139245afe13/BDA/train/train-set-images.tar.gz
      - name: test-set-images
        default: swift://f8a5dbc8033343aea820c139245afe13/BDA/test/test-set-images.tar.gz
      - name: validation-set-images
        default: swift://f8a5dbc8033343aea820c139245afe13/BDA/validation/validation-set-images.tar.gz

- step:
    name: Worker environment check
    image: tensorflow/tensorflow:1.5.0-devel-gpu
    command:
      - pwd
      - ls -la
      - nvidia-smi
      - python --version
      - nvcc --version | grep release
      - cat /usr/include/x86_64-linux-gnu/cudnn_v*.h | grep CUDNN_MAJOR -A 2
